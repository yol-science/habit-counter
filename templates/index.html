<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ç¿’æ…£ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="container">
  <h1>ãƒ©ã‚¤ãƒ•å¼ ç¿’æ…£ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</h1>

  <div class="button-group">
    <button onclick="add('exercise')">é‹å‹•</button>
    <button onclick="add('study')">å‹‰å¼·</button>
    <button onclick="add('meditation')">ç‘æƒ³</button>
  </div>

  <div id="status" class="card-area"></div>
</div>

<script>
function heart(life){
  return "â¤ï¸".repeat(life) + "ğŸ–¤".repeat(3-life)
}

function add(activity){
  fetch("/api/add",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({activity})
  }).then(()=>refresh())
}

function refresh(){
  fetch("/api/today")
    .then(r=>r.json())
    .then(data=>{
      const order = ["exercise","study","meditation"]
      let output=""

      order.forEach(key=>{
        if(data[key]){
          output += `
          <div class="card">
            <h2>${key}</h2>
            <div class="life">${heart(data[key].life)}</div>
            <div class="total">ç´¯è¨ˆ: ${data[key].total}</div>
          </div>
          `
        }
      })

      document.getElementById("status").innerHTML = output
    })
}

refresh()
</script>

</body>
</html>